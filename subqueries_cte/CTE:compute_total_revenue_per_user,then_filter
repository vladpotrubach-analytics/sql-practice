WITH user_revenue AS (
  SELECT
    user_id,
    SUM(revenue) AS total_revenue
  FROM orders
  GROUP BY user_id
)
SELECT *
FROM user_revenue
WHERE total_revenue >= 500
ORDER BY total_revenue DESC;
